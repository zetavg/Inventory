import './ignore-logs';
import './app/utils/readAsArrayBuffer-polyfill';

import { AppRegistry, LogBox, Platform, UIManager } from 'react-native';
import { shim as rnQuickBase64Shim } from 'react-native-quick-base64';

import logger, { getLevelsToLog } from '@app/logger';

import App from '@app/App';

// import StorybookUIRoot from '@app/StorybookUIRoot';
import { name as appName } from './app.json';

rnQuickBase64Shim();

// Polyfill (used by `pouchdb-mapreduce-utils` (promisedCallback), `pouchdb-mapreduce-no-ddocs` from `pouchdb-quick-search`)
process.nextTick = setImmediate;

require('events').EventEmitter.defaultMaxListeners = 32;

process.logger = logger;
process.getLevelsToLog = getLevelsToLog;

if (Platform.OS === 'android') {
  if (UIManager.setLayoutAnimationEnabledExperimental) {
    // Currently causes error "The specified child already has a parent. You must call removeView() on the child's parent first."
    UIManager.setLayoutAnimationEnabledExperimental(false);
  }
}

AppRegistry.registerComponent(appName, () => App);
// AppRegistry.registerComponent(appName, () => StorybookUIRoot);
